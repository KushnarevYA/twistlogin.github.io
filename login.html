<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Login to twist</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
	<link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>
	<div class="container">
		<div class="row mar-20">
			<div class="col-md-12 col-sm-12 text-center">
				<h1>Код:</h1>
				<h1 id="code"></h1>
				<button class="btn btn-primary m-4">Копировать</button>
				<h3 id="success"></h3>
			</div>
		</div>
	</div>
</body>
</html>

<script>
	function getQueryVariable(variable)
	{
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
            var pair = vars[i].split("=");
            if(pair[0] == variable){return pair[1];}
       }
       return(false);
	};

	var state = getQueryVariable("state");
	var code = getQueryVariable("code");

	$("#code").text(state + ";" + code);

	$('button').on('click', function(){
		var text = code;

		var $temp = $("<input>");
		$("body").append($temp);
		$temp.val(code).select();
		document.execCommand("copy");
		$temp.remove();
		$("#success").text("Код скопирован, это окно можно закрыть");
	});

	/*var codeParam = getQueryVariable("code");
	var data = {
		client_id:'9310c253391186e82b22dda1de4236981b3',
		client_secret: '93166f7887a275dbf3607a70f06cfb79317',
		code: codeParam
	};
	console.log('hi');
	var url = 'https://twist.com/oauth/access_token'
	$.ajax({
		url: url,
		data: data,
		type: "POST",
		success: function(data, status){
		console.log(data + " " + status)
	}
	});*/
</script>